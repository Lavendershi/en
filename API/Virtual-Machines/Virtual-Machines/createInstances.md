# createInstances


## Description
Create VM with one or more specified configurations, which is divided into three types: 1. general mode, 2. availability group, 3. use of the starting template. The required and non-required transfer of parameters when creating VM in the three ways is different. <a href="http://docs.jdcloud.com/virtual-machines/api/create_vm_sample">Please refer to details</a><br>
- Creating a VM requires real-name verification
- Instance Type
    - Can query <a href="http://docs.jdcloud.com/virtual-machines/api/describeinstancetypes">DescribeInstanceTypes</a> Interface gets specification information for a specified domain or availability zone
    - It is not possible to use for off-line, or a specification ID of the carnation already sold
- image
    - Windows Server 2012 R2 Standard Edition 64-bit Chinese version SQL Server 2014 Standard SP2 memory needs more than 1 GB;
    - Windows Server all image CPUs must not be selected to exceed 64 cores CPU.
    - Can query <a href="http://docs.jdcloud.com/virtual-machines/api/describeimages">DescribeImages</a> Interface derives image information for the specified zone.
    - The selected image must support the selected instance type. Can query <a href="http://docs.jdcloud.com/virtual-machines/api/describeimageconstraints">DescribeImageConstraints</a> Interface obtains instance type limit information for the specified image.<br>
- Network Instance Type
    - Specify primary network interface configuration information
        - SubnetId must be specified
        - You can specify the elastrological specification to constrain the created EIP, the bandwidth value range[1-100] Mbps, step 1 Mbps
        - The primary intranet IP (primaryIpAddress) of primary network interface can be specified, when maxCount can only be 1
        - The security group securityGroup needs to be within the same VPC as the subnet Subnet
        - A security group must be specified when a VM is created, and  at most 5 security groups are specified. If no security group is specified, the default security group is used by default
        - The primary network interface deveIndex is set to 1
- Storage
    - System Disk
        - Disk classification, system disk support, or cloud
        - Disk Size
            - ERROR: Unable to specify size, default 40GB
            - cloud: Value range: 40-500GB, and cannot be smaller than the minimum system disk size of image; if not specified, the default is the system disk size in the image
        - Auto-delete
            - If local, default auto-deletion, this attribute cannot be modified
            - True if cloud disk paid by configuration
    - Data Disk
        - Disk classification, data disks only support cloud
        - The type of cloud disk can be ssd or premium-hdd
        - Disk Size
            - premium-hdd: Range[20, 3000] GB, Step Size: 10G
            - ssd: Range[20, 1000] GB, Step Size: 10G
        - Auto-delete
            - Auto-deletion by default, for the data disk or shared data disk of the monthly package, this parameter does not take effect
            - SnapshotId can be specified to create a cloud disk
        - You can create a disk from a snapshot
    - The virtual machine with local disk as system disk can be attached with 8 data disks
    - The virtual machine with cloud disk as system disk can be attached with 7 data disks
- Billing
    - Billing mode of EIP. You may choose pay by consumption separately, and the other billing modes are subject to the machine.
    - The billing mode of the cloud disk is subject to the machine
- Others
    - After the creation is complete, the machine status is running
    - Only the Linux system virtual machines can specify key pair
    - maxCount is the maximum effort, and it is not guaranteed that maxCount can be reached
    - The VM's az replaces the az attribute of the disk
- Password
    - <a href="http://docs.jdcloud.com/virtual-machines/api/general_parameters">Refer to the public parameter specification</a>


## Request method
POST

## Request address
https://vm.jdcloud-api.com/v1/regions/{regionId}/instances

|Name|Type|Required or not|Default value|Description|
|---|---|---|---|---|
|**regionId**|String|True| |Region ID|

## Request parameter
|Name|Type|Required or not|Default value|Description|
|---|---|---|---|---|
|**clientToken**|String|False| |The idempotence used to guarantee the request. Generated by the client with a length of no more than 64 characters.<br>|
|**instanceSpec**|InstanceSpec|True| |Describe VM instance type<br>|
|**maxCount**|Integer|False|1|The number of VMs purchased; Value range: [1, 100], 1 by default.<br>|

### InstanceSpec
|Name|Type|Required or not|Default value|Description|
|---|---|---|---|---|
|**agId**|String|False| |Availability Group Id. Once this parameter is specified, the VM can only be created by the instance template associated with the AG, and the parameters in the instance template cannot be replaced. Parameters other than the instance template can be specified.|
|**az**|String|False| |The Availability Zone to which the VM belongs.|
|**charge**|ChargeSpec|False| |Billing Configuration<br>The VM does not support pay by consumption. The default is to pay by configuration.<br>In the case of packaging a data disk, the billing method of the data disk can only be consistent with the VM.<br>In the case of packaging EIP, if the public IP is not specified to be paid by consumption, the IP billing method of the public network can only be consistent with the VM.<br>|
|**dataDisks**|InstanceDiskAttachmentSpec[]|False| |The configuration information of the data disk. The virtual machine with local disk as system disk can be attached with 8 data disks, and 7 data disks for the virtual machine with cloud disk as system disk.|
|**description**|String|False| |Machine Description, <a href="http://docs.jdcloud.com/virtual-machines/api/general_parameters"> Refer to the public parameter specification</a>.|
|**elasticIp**|ElasticIpSpec|False| |EIP specification associated with the primary IP of the primary network interface|
|**imageId**|String|False| |Image ID. Can query <a href="http://docs.jdcloud.com/virtual-machines/api/describeimages">DescribeImages</a> API for the image information of the specified zone.|
|**instanceTemplateId**|String|False| |Instance template id. If the users do not use an availability group, the unavailable information in the instance template needs to be added by the parameters that create the VM, or choose to replace the parameters in the start template.|
|**instanceType**|String|False| |Instance Type. Can query <a href="http://docs.jdcloud.com/virtual-machines/api/describeinstancetypes"> DescribeInstanceTypes</a> API for instance type information of the specified zone or availability zone.|
|**keyNames**|String[]|False| |The key pair name currently only supports incoming one.|
|**name**|String|True| |VM name, <a href="http://docs.jdcloud.com/virtual-machines/api/general_parameters">Refer to the public parameter specification</a>.|
|**password**|String|False| |Password, <a href="http://docs.jdcloud.com/virtual-machines/api/general_parameters">Refer to the public parameter specification</a>.|
|**primaryNetworkInterface**|InstanceNetworkInterfaceAttachmentSpec|False| |Primary Network Interface Configuration Information|
|**systemDisk**|InstanceDiskAttachmentSpec|False| |System Disk Configuration Information|
### ChargeSpec
|Name|Type|Required or not|Default value|Description|
|---|---|---|---|---|
|**chargeDuration**|Integer|False| |Pay-In-Advance billing duration, the Pay-In-Advance is compulsory and valid only when the value of chargeMode is prepaid_by_duration. When chargeUnit is month, the value shall be 1~9; when chargeUnit is year, the value shall be 1, 2 or 3|
|**chargeMode**|String|False|postpaid_by_duration|Billing model value is prepaid_by_duration, postpaid_by_usage or postpaid_by_duration; prepaid_by_duration means Pay-In-Advance; postpaid_by_usage means Pay-As-You-Go By Consumption; and postpaid_by_duration means Pay-As-You-Go by Configuration; postpaid_by_duration is by default. Please refer to the Help Documentation of specific product line to confirm the billing type supported by the production line|
|**chargeUnit**|String|False| |Billing unit of Pay-In-Advance, the Pay-In-Advance is compulsory, and valid only when chargeMode is prepaid_by_duration, and the value is month or year and month by default|
### InstanceDiskAttachmentSpec
|Name|Type|Required or not|Default value|Description|
|---|---|---|---|---|
|**autoDelete**|Boolean|False| |Deleting this disk with the VM automatically when the machine is deleted. The default value is true, which cannot be changed by local.<br>This parameter does not take effect if the billing method of the data disk in the VM is a monthly package.<br>This parameter does not take effect if the data disk in the VM is a shared data disk.<br>|
|**cloudDiskSpec**|DiskSpec|False| |Data Disk Configuration|
|**deviceName**|String|False| |Data disk logical attaching point, value range: vda, vdb, vdc, vdd, vde, vdb, vdg, vdh, vdi|
|**diskCategory**|String|False| |Disk classification, the local or cloud disk is taken.<br>The system disk supports local disk or cloud disk. The system disk selects local type, and the user must use the image localDisk type; if the system disk selects the cloud type, the user must use the image of the cloudDisk type.<br>The data disk supports cloud disk only.<br>|
|**noDevice**|Boolean|False| |Exclude the device, and parameter noDevice is used with deviceName.<br>Create a whole-machine image: deviceName: vdb, noDevice: true, the data disk vdb in the VM is not involved in creating an image.<br>Create a template: deviceName: vdb, noDevice: true, the data disk vdb in the image is not involved in creating the machine.<br>Create a machine: deviceName: vdb, noDevice: true, the data disk vdb in the image or the data disk vdb in the template (create machine by using the template) is not involved in creating the machine.<br>|
### DiskSpec
|Name|Type|Required or not|Default value|Description|
|---|---|---|---|---|
|**az**|String|True| |Availability Zone, to which the cloud disk belongs|
|**charge**|ChargeSpec|False| |Billing configuration. If not specified, the default billing type is pay-as-you-go - pay by service time by default.|
|**description**|String|False| |Description of the cloud disk|
|**diskSizeGB**|Integer|True| |Size of the cloud disk, unit: GiB; ssd value range of [20,1000]GB and step size of 10G; premium-hdd value range of [20,3000]GB and step size of 10G|
|**diskType**|String|True| |Type of the cloud disk, value ssd or premium-hdd|
|**multiAttachable**|Boolean|False| |Whether the cloud disk supports the mode that one disk is attached to multiple machines. It is set as false by default (not supported).|
|**name**|String|True| |Name of the cloud disk|
|**snapshotId**|String|False| |Snapshot ID used to create a cloud disk|
### ElasticIpSpec
|Name|Type|Required or not|Default value|Description|
|---|---|---|---|---|
|**bandwidthMbps**|Integer|True| |Elastic IP Speed lLimit (unit: Mbps). Value Range: [1-200]|
|**chargeSpec**|ChargeSpec|False| |Billing Configuration|
|**provider**|String|True| |IP service provider, values include bgp or no_bgp, cn-north-1: bgp; cn-south-1: [bgp, no_bgp]; cn-east-1: [bgp, no_bgp]; cn-east-2: bgp|
### InstanceNetworkInterfaceAttachmentSpec
|Name|Type|Required or not|Default value|Description|
|---|---|---|---|---|
|**deviceIndex**|Integer|False| |Network device Index, and the primary network interface can only be 1|
|**networkInterface**|NetworkInterfaceSpec|False| |Network Interface API Instance Type|
### NetworkInterfaceSpec
|Name|Type|Required or not|Default value|Description|
|---|---|---|---|---|
|**az**|String|False| |Availability Zone, User’s Default Availability Zone|
|**description**|String|False| |Description, allow all characters under UTF-8 coding, which cannot exceed 256 characters|
|**networkInterfaceName**|String|False| |Network interface name, only allow Chinese, numbers, capital and lowercase letters, English underline “_” and line-through “-”, must provide a name which cannot exceed 32 characters.|
|**primaryIpAddress**|String|False| |Network interface primary IP, if it has not been assigned, it will be allocated automatically from the subnet|
|**sanityCheck**|Integer|False| |Source and target IP address verification, with value 0 or 1, default value is 1|
|**secondaryIpAddresses**|String[]|False| |Secondary IP List|
|**secondaryIpCount**|Integer|False| |Amount of Secondary IP Allocated Automatically|
|**securityGroups**|String[]|False| |Security Group ID list to be associated, a maximum of 5 Security Groups can be done|
|**subnetId**|String|True| |Subnet ID|

## Response parameter
|Name|Type|Description|
|---|---|---|
|**requestId**|String| |
|**result**|Result| |

### Result
|Name|Type|Description|
|---|---|---|
|**instanceIds**|String[]| |

## Response code
|Return code|Description|
|---|---|
|**400**|Invalid parameter|
|**401**|Authentication failed|
|**500**|Internal server error|
|**503**|Service unavailable|
|**200**|OK|
|**404**|Not found|
|**429**|Quota exceeded|
